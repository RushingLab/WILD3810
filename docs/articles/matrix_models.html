<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modeling population dynamics using matrix projection models • WILD3810</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Modeling population dynamics using matrix projection models">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WILD3810</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2019.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Lecture0/Lecture0.html">Lecture 0: Introduction to WILD3810</a>
    </li>
    <li>
      <a href="../articles/Lecture1/Lecture1.html">Lecture 1: Introduction to population ecology</a>
    </li>
    <li>
      <a href="../articles/Lecture2/lecture2.html">Lecture 2: How many are there? Estimating abundance</a>
    </li>
    <li>
      <a href="../articles/Lecture3/lecture3.html">Lecture 3: Introduction to population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture4/Lecture4.html">Lecture 4: Density-dependent population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture6/lecture6.html">Lecture 6: Stochasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture7/Lecture7.html">Lecture 7: Dynamics of small populations</a>
    </li>
    <li>
      <a href="../articles/Lecture8/Lecture8.html">Lecture 8: Life Tables</a>
    </li>
    <li>
      <a href="../articles/Lecture9/Lecture9.html">Lecture 9: Survival estimation</a>
    </li>
    <li>
      <a href="../articles/Lecture10/Lecture10.html">Lecture 10: Reproduction</a>
    </li>
    <li>
      <a href="../articles/Lecture11/Lecture11.html">Lecture 11: Introduction to matrix projection models</a>
    </li>
    <li>
      <a href="../articles/Lecture12/Lecture12.html">Lecture 12: Stage-structured population models</a>
    </li>
    <li>
      <a href="../articles/Lecture13/Lecture13.html">Lecture 13: Reproductive value, sensitivity, and elasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture14/Lecture14.html">Lecture 14: Life history variation</a>
    </li>
    <li>
      <a href="../articles/Lecture15/Lecture15.html">Lecture 15: Metapopulation models</a>
    </li>
    <li>
      <a href="../articles/Lecture16/Lecture16.html">Lecture 16: Metapopulation models II</a>
    </li>
    <li>
      <a href="../articles/Lecture17/Lecture17.html">Lecture 17: Source-sink dynamics</a>
    </li>
    <li>
      <a href="../articles/Lecture18/Lecture18.html">Lecture 18: Intraspecific competition</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab1.html">Lab 1a: Introduction to R and mark-recapture</a>
    </li>
    <li>
      <a href="../articles/rmarkdown_intro.html">Lab 1b: Introduction to R Markdown</a>
    </li>
    <li>
      <a href="../articles/lab2.html">Lab 2: Modeling population dynamics</a>
    </li>
    <li>
      <a href="../articles/lab3.html">Lab 3: Population viability analysis</a>
    </li>
    <li>
      <a href="../articles/life_table.html">Lab 4: Building and interpreting static life tables</a>
    </li>
    <li>
      <a href="../articles/matrix_models.html">Lab 5: Modeling population dynamics using matrix projection models</a>
    </li>
    <li>
      <a href="../articles/matrix_models2.html">Lab 6: Modeling population dynamics using matrix projection models, part 2</a>
    </li>
    <li>
      <a href="../articles/source-sink.html">Lab 8: Source-sink metapopulation dynamics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/homework.html">
    <span class="fas fa fas fa-pencil-square-o"></span>
     
    Assignments
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Modeling population dynamics using matrix projection models</h1>
                        <h4 class="author">WILD3810: Plant and animal populations</h4>
            
      
      
      <div class="hidden name"><code>matrix_models.Rmd</code></div>

    </div>

    
    
<p>In this lab, you will build a matrix population model from published demographic data. This lab will help get you started on how to build the matrix and explore its properties. You will then complete the exercise as part of this week’s homework assignment. If you complete the entire assignment during lab, that is fine. Otherwise, you will need to complete the assignment on your own.</p>
<hr>
<p><strong>Objectives</strong></p>
<ul>
<li><p>Build a matrix population model using published demographic data</p></li>
<li><p>Practice adding data to a matrix using <code>for</code> loops</p></li>
<li><p>Practice visualizing data using <code>ggplot2</code></p></li>
<li>
<code>R</code> functions used in this exercise:
<ul>
<li><code><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix()</a></code></li>
<li><code><a href="https://www.rdocumentation.org/packages/base/topics/colSums">rowSums()</a></code></li>
</ul>
</li>
</ul>
<hr>
<div id="setting-up-the-lab" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-up-the-lab" class="anchor"></a>Setting up the lab</h2>
<p>In order to organize your code and files for this homework assignment, start by creating a new project:</p>
<ol style="list-style-type: decimal">
<li><p>Open <code>RStudio</code></p></li>
<li><p>Click <code>File -&gt; New Project</code></p></li>
</ol>
<p><img src="figs/new_file.png" width="100%"></p>
<ol start="3" style="list-style-type: decimal">
<li>Click <code>New Directory</code>
</li>
</ol>
<p><img src="figs/project_options.png" width="100%"></p>
<ol start="4" style="list-style-type: decimal">
<li>Click <code>New Project</code>
</li>
</ol>
<p><img src="figs/new_project2.png" width="100%"></p>
<ol start="5" style="list-style-type: decimal">
<li>Name the project <code>matrix_model</code> and create it within your <code>WILD3810</code> folder (click <code>Browse</code> and navigate to this folder if necessary)</li>
</ol>
<p><img src="figs/pva_project.png" width="100%"></p>
<ol start="6" style="list-style-type: decimal">
<li><p>Click <code>Create project</code></p></li>
<li><p>Click <code>File -&gt; New File -&gt; R Markdown</code></p></li>
</ol>
<p><img src="figs/new_file.png" width="100%"></p>
<ol start="8" style="list-style-type: decimal">
<li>Select <code>From Template</code>; scroll down and select <code>WILD3810-Homework5</code>
</li>
</ol>
<p><img src="figs/from_template.png" width="100%"></p>
<ol start="9" style="list-style-type: decimal">
<li>In the <code>Name</code> box, type <code>LastnameFirstName-Homework5</code>
</li>
</ol>
<p><img src="figs/homework_name.png" width="100%"></p>
<ol start="10" style="list-style-type: decimal">
<li><p>Click <code>Ok</code></p></li>
<li><p>Make sure you have the most update-to-date version of <code>WILD3810</code> by running:</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"RushingLab/WILD3810"</span>)</code></pre></div>
<hr>
<p><strong>Note</strong>: You will use the homework 5 template to complete the rest of this lab activity. You can copy the code below to your assignment template to start the assignment. However, you <strong>do not</strong> need to copy code the prints objects, only the code the creates or manipulates the objects.</p>
<hr>
</div>
<div id="modeling-the-dynamics-of-brown-headed-cowbirds" class="section level2">
<h2 class="hasAnchor">
<a href="#modeling-the-dynamics-of-brown-headed-cowbirds" class="anchor"></a>Modeling the dynamics of Brown-headed cowbirds</h2>
<p>The Brown-headed cowbird (<em>Molothrus ater</em>) is a songbird native to the short-grass prairies of North America. Although historically restricted to small patches of suitable prairie, expansion of agriculture and conversion of forested habitats into fragmented, open landscapes allowed cowbird populations to expand and increase dramatically over the past two centuries.</p>
<div class="figure" style="text-align: center">
<img src="https://upload.wikimedia.org/wikipedia/commons/9/9f/Brown-Headed_Cowbird.jpg" alt="Male Brown-headed cowbird. Photo courtesy of http://www.naturespicsonline.com/  via Wikicommons" width="75%"><p class="caption">
Male Brown-headed cowbird. Photo courtesy of <a href="http://www.naturespicsonline.com/" class="uri">http://www.naturespicsonline.com/</a> via Wikicommons
</p>
</div>
<p>Growth and expansion of cowbird populations has been detrimental many other native songbirds because cowbirds are nest parasites. Female cowbirds lay their eggs in the nest of at least 220 other species, letting the host parents incubate the eggs and raise the offspring. Without the need to build a nest or tend to their young, this strategy allows cowbirds to lay up to 40 eggs in a single season. Additionally, cowbird eggs often have a shorter incubation period than most of their hosts, allowing the newly hatched cowbirds to out compete the host offspring (newly hatched cowbirds can even push the unhatched host eggs out of the nest!). Although species that evolved alongside cowbirds often have defenses to protect their nest and eggs against cowbird parasitism, species that have encountered cowbirds only after their expansion often suffer near total reproductive failure. In fact, parasitism by cowbirds has been one of the primary threats to several endangered species, including Kirtland’s warblers (<em>Setophaga kirtlandii</em>), Golden-cheeked warblers (<em>Setophaga chrysoparia</em>), and Black-capped vireos (<em>Vireo atricapilla</em>). As a result, cowbirds have been the target of intense management efforts to reduce their populations since at least the 1970’s.</p>
<div class="figure" style="text-align: center">
<img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Cowbird_egg.JPG" alt="Brown-headed cowbird egg in the nest of an Eastern Phoebe. Photo courtesy of Frankie Rose  via Wikicommons" width="45%"><p class="caption">
Brown-headed cowbird egg in the nest of an Eastern Phoebe. Photo courtesy of Frankie Rose via Wikicommons
</p>
</div>
<div id="brown-headed-cowbird-vital-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#brown-headed-cowbird-vital-rates" class="anchor"></a>Brown-headed cowbird vital rates</h3>
<p>Due to the management focus that cowbirds have received over the past several decades, a number of studies have measured their survival and fecundity. Luckily for us, these data were compiled by several researchers that were interested in creating a matrix population model for the species<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. The table below contains the average, high, and low estimates from published studies of relevant cowbird vital rates:</p>
<table class="table table">
<thead><tr>
<th style="text-align:center;">
Vital rate
</th>
<th style="text-align:center;">
Average
</th>
<th style="text-align:center;">
Low
</th>
<th style="text-align:center;">
High
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Adult Fecundity
</td>
<td style="text-align:center;">
13.80
</td>
<td style="text-align:center;">
10.20
</td>
<td style="text-align:center;">
16.00
</td>
</tr>
<tr>
<td style="text-align:center;">
Yearling Fecundity
</td>
<td style="text-align:center;">
11.20
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
Egg survival
</td>
<td style="text-align:center;">
0.38
</td>
<td style="text-align:center;">
0.08
</td>
<td style="text-align:center;">
0.68
</td>
</tr>
<tr>
<td style="text-align:center;">
Nestling survival
</td>
<td style="text-align:center;">
0.64
</td>
<td style="text-align:center;">
0.46
</td>
<td style="text-align:center;">
0.76
</td>
</tr>
<tr>
<td style="text-align:center;">
Yearling survival
</td>
<td style="text-align:center;">
0.24
</td>
<td style="text-align:center;">
0.15
</td>
<td style="text-align:center;">
0.32
</td>
</tr>
<tr>
<td style="text-align:center;">
Adult survival
</td>
<td style="text-align:center;">
0.47
</td>
<td style="text-align:center;">
0.31
</td>
<td style="text-align:center;">
0.63
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>1</sup> Fecundity is the number of female eggs laid each year, assuming 50:50 sex ratio
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>2</sup> Egg survival is the probability that eggs survive from laying to hatching
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>3</sup> Nestling survival is the probability that nestlings survive from hatching to fledging
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>4</sup> Yearling survival is the probability that juveniles survive from fledging to the following breeding season
</td>
</tr>
</tfoot>
</table>
<p>You will use these estimates to build a matrix population model for cowbirds.</p>
</div>
<div id="estimating-relevant-vital-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#estimating-relevant-vital-rates" class="anchor"></a>Estimating relevant vital rates</h3>
<p>Your goal is to convert the values in the above table into the relevant entries of a matrix that describes age-specific cowbird demographic rates.</p>
<p>Before you can do that, you need to determine what age/stage classes are relevant to the matrix and which vital rates you will need to estimate to fill in the matrix elements. The data we are using assume that the population is monitored annually during the breeding season and therefore we obtain counts of eggs and adults. This means that we need to model the population using <strong>annual rates</strong>. However, the first year of life includes three stages: egg, nestling, and yearling (this is why the table above includes vital rates for each of those three stages).</p>
<hr>
<p><strong>Before moving on, answer questions 1a &amp; 1b on the homework file</strong></p>
<hr>
<p>To create the matrix, you will need to take the vital rates in the table above (for now, just use the average rates) and combine them to create the relevant matrix elements. In the chunk called <code>bhco_mat</code>, write the necessary code to create the matrix values based on your answers to 1a and 1b.</p>
</div>
<div id="creating-matrices-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-matrices-in-r" class="anchor"></a>Creating matrices in <code>R</code>
</h3>
<p>Next, you will need to create the matrix. So far in this class, we have learned to create vector objects and data frames. For this lab, we will need to create a different type of object - matrices. Creating a matrix can be done using the <code><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix()</a></code> function. This function takes a vector that includes all of the values that make up the matrix (remember - to create a vector, use the <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c()</a></code> function) as well as the number of rows and columns that define the matrix. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>,
              <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="dv">0</span>,
              <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,] 0.00  2.0    4</span>
<span class="co">#&gt; [2,] 0.25  0.0    0</span>
<span class="co">#&gt; [3,] 0.00  0.5    0</span></code></pre></div>
<p>Notice that the values within the <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c()</a></code> function form a single vector even though I entered the values on three lines. Putting them on different lines is not necessary but does make it easier to keep track of how the final matrix is organized (in this case, a <span class="math inline">\(3x3\)</span> matrix with values <code>0, 2, 4</code> on the first row, <code>0.25, 0, 0</code> on the second row, and <code>0, 0.5, 0</code> on the third row). One important behavior of this function is that by default, <code><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix()</a></code> will create the matrix <em>by column</em>. We entered our data as rows so we need to specify <code>byrow = TRUE</code>. If we did not use this option, we would get:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>,
              <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="dv">0</span>,
              <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>))
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    0 0.25  0.0</span>
<span class="co">#&gt; [2,]    2 0.00  0.5</span>
<span class="co">#&gt; [3,]    4 0.00  0.0</span></code></pre></div>
<p>Not the matrix we wanted! Be very careful about this option when you are creating matrices of your own.</p>
<p>In your homework template, enter the code necessary to create a matrix describing the demographic rates of Brown-headed cowbirds and answer question 2. <strong>Note that your code should not be placed inside of parentheses like the code above. This is done so that the resulting matrix was printed to the console when created. You do not need to print the matrix in the homework template</strong></p>
</div>
</div>
<div id="projecting-the-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#projecting-the-matrix" class="anchor"></a>Projecting the matrix</h2>
<p>With the matrix now created, you can predict the future dynamics of the hypothetical cowbird population. To start, let’s assume that in the first year there are 5000 individuals. Within those 5000 individuals, we will randomly generate initial sizes within each stage. To do that, we’ll first determine the number of eggs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N1 &lt;-<span class="st"> </span>?
eggs1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">min =</span> ?, <span class="dt">max =</span> ?), <span class="dt">digits =</span> ?)</code></pre></div>
<p>Copy the above code into the chunk called <code>init_N</code> and replace the question marks with the correct values. Next, calculate the number of adults (replacing the question mark with the correct values):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">adults1 &lt;-<span class="st"> </span>?</code></pre></div>
<p>To make our projection easier to keep track of, we’ll store the annual stage-specific abundances in another matrix. You will need to determine the number of years for your simulation and then create an empty matrix to store the abundances:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nYears &lt;-<span class="st"> </span>?
  
N &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> ?, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p>Now assign the first column the initial abundances you created above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N[<span class="dv">1</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span>eggs1
N[<span class="dv">1</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>adults1</code></pre></div>
<p>Now you are ready to simulate future population sizes. You will need to do this using a <code>for</code> loop. Remember that:</p>
<p><span class="math display">\[\large \mathbf N_{t + 1} = \mathbf A \times \mathbf N_t\]</span></p>
<p>where <span class="math inline">\(\mathbf N_{t}\)</span> is the matrix containing the current stage-specific abundance and <span class="math inline">\(\mathbf A\)</span> is the population matrix.</p>
<hr>
<p><strong>Matrix multiplication in <code>R</code></strong>: To do matrix multiplication in <code>R</code>, you will need a special function: <code>%*%</code>. Remember to put your matrices in the correct order! (<span class="math inline">\(\mathbf A \times \mathbf N\)</span> is <strong>not</strong> the same as <span class="math inline">\(\mathbf N \times \mathbf A\)</span>)</p>
<hr>
<p>Complete the code below to run your loop:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(t <span class="cf">in</span> ?<span class="op">:</span>?){
  N[t,] &lt;-<span class="st"> </span>?
}</code></pre></div>
</div>
<div id="examining-the-growth-of-brown-headed-cowbirds" class="section level2">
<h2 class="hasAnchor">
<a href="#examining-the-growth-of-brown-headed-cowbirds" class="anchor"></a>Examining the growth of brown-headed cowbirds</h2>
<p>Now that you have projected population size, you can examine the dynamics of this population.</p>
<div id="transient-dynamics" class="section level3">
<h3 class="hasAnchor">
<a href="#transient-dynamics" class="anchor"></a>Transient dynamics</h3>
<p>Because we started the population at a random stage distribution, your population likely underwent some period of transient dynamics. To examine how long these dynamics lasted, you first need to create a data frame with the stage-specific abundances:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Year =</span> <span class="dv">1</span><span class="op">:</span>nYears,
                   <span class="dt">N =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(N),
                   <span class="dt">Stage =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Eggs"</span>, <span class="st">"Adults"</span>), <span class="dt">each =</span> nYears))</code></pre></div>
<p>Now complete the following code to plot the <strong>log of N</strong> for each stage:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(?, <span class="kw">aes</span>(<span class="dt">x =</span> ?, <span class="dt">y =</span> ?, <span class="dt">color =</span> ?)) <span class="op">+</span><span class="st"> </span>geom_?()</code></pre></div>
<p>After you have made the plot, answer question 3 in the homework.</p>
</div>
<div id="stable-stage-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#stable-stage-distribution" class="anchor"></a>Stable stage distribution</h3>
<p>Using either the <code>N</code> matrix you can also estimate the stable stage distribution. One way to estimate the stage distribution in each year is to divide the <code>N</code> matrix by the total annual population sizes. To do this, first create the total population size in each year:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N_tot &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">rowSums</a></span>(N)</code></pre></div>
<p>At this point in the semester, you should be able to do the rest without any starter code. In your homework template, create the code necessary to estimate the stage distribution in each year and answer questions 4a &amp; 4b.</p>
</div>
<div id="asymptotic-large-lambda" class="section level3">
<h3 class="hasAnchor">
<a href="#asymptotic-large-lambda" class="anchor"></a>Asymptotic <span class="math inline">\(\large \lambda\)</span>
</h3>
<p>Next, estimate the asymptotic growth rate. To do this, you will need to create an empty vector to store the annual <span class="math inline">\(\lambda\)</span> value for each year and then fill in the values using a <code>for</code> loop. In the homework template, complete the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
lambda_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Year =</span> <span class="dv">1</span><span class="op">:</span>?,
                        <span class="dt">lambda =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>(<span class="dt">length =</span> ?))

<span class="cf">for</span>(t <span class="cf">in</span> ?<span class="op">:</span>?){
  ?
}</code></pre></div>
<p>Next, use <code>ggplot2</code> to create a line graph showing how the annual <span class="math inline">\(\lambda\)</span> values changed across time. Again, at this stage you should be able to do that without starter code.</p>
</div>
<div id="population-inertia" class="section level3">
<h3 class="hasAnchor">
<a href="#population-inertia" class="anchor"></a>Population inertia</h3>
<p>Now that you know the SSD for this population, simulate the dynamics of a second population that also starts with 5000 individuals but at the SSD. Copy the necessary code from above but change the initial values to match the SSD you estimated above (also change the names of the objects you create!). Then complete the code below to visualize the resulting population growth:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N_ssd_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Year =</span> <span class="dv">1</span><span class="op">:</span>nYears,
                       <span class="dt">N =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(N_tot, N_tot_ssd),
                       <span class="dt">Initial =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Random"</span>, <span class="st">"SSD"</span>), <span class="dt">each =</span> nYears))</code></pre></div>
<p>Finally, use <code>ggplot2</code> to plot the log population size across years for each simulated population. Make sure the color of each line corresponds to the initial conditions and then answer questions 6a-6c.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Data used in this project are from Citta, J. J., &amp; Scott Mills, L. (1997). What do demographic sensitivity analyses tell us about controlling brown-headed cowbirds?. <em>Studies in Avian Biology</em>, 18, 121-134.<a href="#fnref1">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setting-up-the-lab">Setting up the lab</a></li>
      <li><a href="#modeling-the-dynamics-of-brown-headed-cowbirds">Modeling the dynamics of Brown-headed cowbirds</a></li>
      <li><a href="#projecting-the-matrix">Projecting the matrix</a></li>
      <li><a href="#examining-the-growth-of-brown-headed-cowbirds">Examining the growth of brown-headed cowbirds</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
