<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 1: Introduction to mark-recapture - estimating abundance • WILD3810</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 1: Introduction to mark-recapture - estimating abundance">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WILD3810</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2020.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Lecture0/Lecture0.html">Lecture 0: Introduction to WILD3810</a>
    </li>
    <li>
      <a href="../articles/Lecture1/Lecture1.html">Lecture 1: Introduction to population ecology</a>
    </li>
    <li>
      <a href="../articles/Lecture2/lecture2.html">Lecture 2: Abundance</a>
    </li>
    <li>
      <a href="../articles/Lecture3/lecture3.html">Lecture 3: Density-independent population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture4/Lecture4.html">Lecture 4: Stochasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture5/Lecture5.html">Lecture 5: Density-dependent population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture6/lecture6.html">Lecture 6: Dynamics of small populations</a>
    </li>
    <li>
      <a href="../articles/Lecture7/Lecture7.html">Lecture 7: Life tables</a>
    </li>
    <li>
      <a href="../articles/Lecture8/Lecture8.html">Lecture 8: Survival estimation</a>
    </li>
    <li>
      <a href="../articles/Lecture9/Lecture9.html">Lecture 9: Reproduction</a>
    </li>
    <li>
      <a href="../articles/Lecture10/Lecture10.html">Lecture 10: Matrix population models</a>
    </li>
    <li>
      <a href="../articles/Lecture11/Lecture11.html">Lecture 11: Stage-structured populations</a>
    </li>
    <li>
      <a href="../articles/Lecture12/Lecture12.html">Lecture 12: Reproductive value, sensitivity, and elasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture13/Lecture13.html">Lecture 13: Life history variation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab0.html">Lab 0a: Introduction to R and R Markdown</a>
    </li>
    <li>
      <a href="../articles/rmarkdown_intro.html">Lab 0b: Introduction to R Markdown</a>
    </li>
    <li>
      <a href="../articles/lab1.html">Lab 1: Introduction to R (cont.)/Abundance estimation</a>
    </li>
    <li>
      <a href="../articles/lab2.html">Lab 2: Introduction to R/Modeling population growth</a>
    </li>
    <li>
      <a href="../articles/lab3.html">Lab 3: Modeling population growth (continued)</a>
    </li>
    <li>
      <a href="../articles/lab4.html">Lab 4: Population viability analysis</a>
    </li>
    <li>
      <a href="../articles/lab5_life_tables.html">Lab 5: Creating and interpreting a life table</a>
    </li>
    <li>
      <a href="../articles/lab6_matrix_models.html">Lab 6: Modeling population dynamics using matrix projection models</a>
    </li>
    <li>
      <a href="../articles/lab7_tree_harvest.html">Lab 7: Applications of matrix population models - Sustainable tree harvest</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/homework.html">
    <span class="fas fa fas fa-pencil-square-o"></span>
     
    Assignments
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="lab1_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Lab 1: Introduction to mark-recapture - estimating abundance</h1>
            <h3 class="subtitle">WILD3810: Plant and animal populations</h3>
                        <h4 class="author">Spring 2020</h4>
            
      
      
      <div class="hidden name"><code>lab1.Rmd</code></div>

    </div>

    
    
<p>In this lab, we will continue learning how to use <code>R</code> to create and manipulate objects, with a particular focus on estimating abundance using the Lincoln-Peterson estimator.</p>
<hr>
<p><strong>Objectives</strong></p>
<ul>
<li>Learn/review basic data types, including:
<ul>
<li>Scalars</li>
<li>Vectors</li>
<li>Numeric objects</li>
<li>Character objects</li>
</ul>
</li>
<li>Learn/review basic data manipulation tasks, including:
<ul>
<li>Vector algebra</li>
</ul>
</li>
<li>
<code>R</code> functions used in this exercise:
<ul>
<li><code><a href="https://www.rdocumentation.org/packages/base/topics/prod">prod()</a></code></li>
<li><code><a href="https://www.rdocumentation.org/packages/base/topics/Round">round()</a></code></li>
<li><code><a href="https://www.rdocumentation.org/packages/base/topics/c">c()</a></code></li>
<li><code><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum()</a></code></li>
</ul>
</li>
</ul>
<hr>
<div id="set-up" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up" class="anchor"></a>Set up</h1>
<ol style="list-style-type: decimal">
<li><p>Log in to R Studio Cloud</p></li>
<li><p>Create a new project called <code>LastnameFirstname-Lab1</code></p></li>
<li>
<p>Create a new R script file to store code from this lab:</p>
<p>3a) Click <code>File -&gt; New File -&gt; R Script</code></p>
<p>3b) Save the script as <code>Lab1</code></p>
</li>
</ol>
<div id="the-lincoln-peterson-estimator" class="section level2">
<h2 class="hasAnchor">
<a href="#the-lincoln-peterson-estimator" class="anchor"></a>The Lincoln-Peterson estimator</h2>
<p>Remember from lecture 2 that the Lincoln-Peterson method is used to estimate the abundance of a closed population using mark-recapture data. As a reminder, the Lincoln-Peterson estimator is:</p>
<p><span class="math display">\[N = \frac{n_1n_2}{m_2}\]</span></p>
<p>where <span class="math inline">\(n_1\)</span> is the number of individuals captured (and marked) on the first sampling occasion, <span class="math inline">\(n_2\)</span> is the number of individuals captured on the second sampling occasion, and <span class="math inline">\(m_2\)</span> is the number of marked individuals in the second sample.</p>
<p>Let’s use <code>R</code>to estimate N for some made up data. In the script you just opened, create three new objects that represent the parameters in the Lincoln-Peterson estimator. Modify the following code to tell <code>R</code>that we captured 44 individuals on the first occasion, 32 on the second, and of those 32 sampled on the second occasion, 15 were marked:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">n1 &lt;-</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">n2 &lt;-</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">m2 &lt;-<span class="st"> </span></a></code></pre></div>
<p>Remember that R will ignore any code that follows a <code>#</code>. Before moving on, use comments to define what each object represents (e.g., <code>Number of individuals captured on first occasion</code>, <code>Number of individuals captured on second occasion</code>, <code>Number of previously marked individuals captured on second occasion</code>)</p>
<p>After entering the code and comments, highlight all three lines and then click <code>Ctrl + Enter</code> (or <code>command + return</code> on Mac) to run the code. Note that you should see the code in the console.</p>
<p>Now add a new line of code (put your cursor at the end of the <code>m2 &lt;-</code> line and hit enter) and estimate <span class="math inline">\(N\)</span> from our newly created objects using the Lincoln-Peterson:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">N &lt;-<span class="st"> </span>n1 <span class="op">*</span><span class="st"> </span>n2 <span class="op">/</span><span class="st"> </span>m2</a></code></pre></div>
<p>What is the estimated abundance of this population?</p>
<p>Remember that, in addition to our estimate of N, we always need to know something about how certain we are in the estimate. On your own, create a new object called <code>varN</code> to calculate the variance of our estimated N, remembering that:</p>
<p><span class="math display">\[\large var(\hat{N}) = \frac{(n_1 + 1)(n_2+1)(n_1-m_2)(n_2-m_2)}{(m_2+1)^2(m_2+2)}\]</span></p>
<p>Hints: Remember that the entire numerator (and denominator) needs to be contained within parentheses; to square something in <code>R</code>, use <code>^2</code></p>
</div>
</div>
<div id="exercise-2-the-schnabel-method" class="section level1">
<h1 class="hasAnchor">
<a href="#exercise-2-the-schnabel-method" class="anchor"></a>Exercise 2: The Schnabel method</h1>
<p>To better understand how we use vectors in <code>R</code> and to expand on our discussion of abundance estimation, we will learn how to use the <strong>Schnabel method</strong> to estimate <span class="math inline">\(N\)</span>.</p>
<p>In many studies, researchers attempt to re-sight marked individuals on more than 2 occasions. Unfortunately, the Lincoln-Peterson method is restricted to data from only 2 capture occasions, meaning that to use it, we have to throw out data from occasions <span class="math inline">\(3,4,...,T\)</span>.</p>
<p>In the 1930’s, a mathematician at the University of Wisconsin named Zoe Emily Schnabel, expanded on the Lincoln-Peterson method to include <span class="math inline">\(&gt;2\)</span> occasions. The Schnabel method uses three pieces of information collected at each occasion: <strong><span class="math inline">\(C_t\)</span></strong>, the number of captured individuals during occasion <span class="math inline">\(t\)</span>; <strong><span class="math inline">\(R_t\)</span></strong>, the number of recaptures captured during occasion <span class="math inline">\(t\)</span>; and <strong><span class="math inline">\(M_t\)</span></strong>, the number of individuals marked in the population at occasion <span class="math inline">\(t\)</span> (or, the total number of marked individuals at risk of being captured on occasion <span class="math inline">\(t\)</span>). Using these data, the Schnabel estimator is:</p>
<p><span class="math display">\[\hat{N} = \frac{\sum_t(C_t \times M_t)}{\sum_t R_t}\]</span> <em>Remember that <span class="math inline">\(\sum_t\)</span> means the sum of the values across at <span class="math inline">\(T\)</span> occasions.</em></p>
<p>To better understand what each of these data mean, we will use an example from <a href="http://docs.wixstatic.com/ugd/95e73b_6d832c61405d4b3cbd9d99bbb4530f7b.pdf">Powell &amp; Gale (2015)</a> (pages 96-97). Students on a research trip to Puerto Rico did a 3-day mark-recapture study to estimate the number of Cuban rock iguanas (<em>Cyclura nubila</em>) on the island Isla Magueyes. On the first day, the students observed and marked (using latex paint) 155 iguanas. On the second day, they observed 175 individuals (109 marked and 66 unmarked; note that the 66 unmarked individuals were captured, marked, and released). On the third day, they observed 131 individuals (116 marked and 15 unmarked).</p>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:center;">
Day
</th>
<th style="text-align:center;">
Animals Observed
</th>
<th style="text-align:center;">
Animal with marks
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
155
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
175
</td>
<td style="text-align:center;">
109
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
131
</td>
<td style="text-align:center;">
116
</td>
</tr>
</tbody>
</table>
<p>In this example, <span class="math inline">\(C_t =\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">Ct &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">155</span>, <span class="dv">175</span>, <span class="dv">131</span>) <span class="co"># Number of captures during each occassion</span></a></code></pre></div>
<p>and <span class="math inline">\(R_t =\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">Rt &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">109</span>, <span class="dv">116</span>) <span class="co"># Number of recaptures during each occassion</span></a></code></pre></div>
<p>What is <span class="math inline">\(M_t\)</span>? On the first day, there are no previously marked individuals so <span class="math inline">\(M_1=0\)</span>. On the second day, there are 155 marked individuals in the population (all of the individuals marked on day 1) so <span class="math inline">\(M_2=155\)</span>. On day 3, the students could have observed individuals marked on the first day or individuals marked on the second day (<span class="math inline">\(175-109=66\)</span> individuals marked on day 2) so <span class="math inline">\(M_3 = 155 + 66 = 221\)</span>. So:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">Mt &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">155</span>, <span class="dv">221</span>) <span class="co"># Number of recaptures during each occassion</span></a></code></pre></div>
<p>Now to estimate <span class="math inline">\(\hat{N}\)</span>. We <em>could</em> do it by hand:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">N &lt;-<span class="st"> </span>((<span class="dv">155</span><span class="op">*</span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">175</span> <span class="op">*</span><span class="st"> </span><span class="dv">155</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">131</span> <span class="op">*</span><span class="st"> </span><span class="dv">221</span>)) <span class="op">/</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">109</span> <span class="op">+</span><span class="st"> </span><span class="dv">116</span>)</a></code></pre></div>
<p>However, that is <em>a lot</em> of typing and it’s pretty likely we would make a mistake somewhere along the way (typos or misplaced parentheses). <code>R</code> is clever enough to allow us to use the previously created vectors. First, let’s see what happens when we multiply two vectors together:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">Ct <span class="op">*</span><span class="st"> </span>Mt</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; [1]     0 27125 28951</span></a></code></pre></div>
<p>As you can see, we created a new vector that is the same length as the original vectors (3). When you multiply (or add, subtract, or divide) two vectors, <code>R</code> multiplies the first element of first vector times the first element of the second vector, the second element of first vector times the second element of the second vector, the third element of first vector times the third element of the second vector, etc, and then combines them into a new vector.</p>
<p>We can also use the <code><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum()</a></code> function to add up all of the elements of a vector (similar to the <code><a href="https://www.rdocumentation.org/packages/base/topics/prod">prod()</a></code> function we saw earlier). So:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">N &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(Ct <span class="op">*</span><span class="st"> </span>Mt) <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(Rt)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="dt">x =</span> N, <span class="dt">digits =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; [1] 249</span></a></code></pre></div>
<p>Much easier!</p>
<div id="properties-of-the-lincoln-peterson-estimator" class="section level2">
<h2 class="hasAnchor">
<a href="#properties-of-the-lincoln-peterson-estimator" class="anchor"></a>Properties of the Lincoln-Peterson estimator</h2>
<p>In the next homework, we will use <code>R</code> to better understand the properties of the LP estimator. To create this homework:</p>
<ol style="list-style-type: decimal">
<li>
<p>Create a new R Markdown file from the Homework-1 template:</p>
<p>1a) Click <code>File -&gt; New File -&gt; R Markdown</code></p>
<p>1b) Click <code>From Template</code> and scroll down to <code>WILD3810-Homework1</code></p>
<p>1c) In the <code>Name</code> box, type <code>LastnameFirstname-Homework1</code></p>
<p>1d) Click <code>Ok</code></p>
</li>
<li>
<p>Ensure that you can <code>Knit</code> the file</p>
<p>2a) Change “YOUR NAME HERE” in the header section to your name</p>
<p>2b) Click <code>Knit</code> to make sure you can knit the .Rmd file</p>
</li>
<li><p>Complete the assignment as directed in the .Rmd file</p></li>
<li><p>Follow the <a href="https://rushinglab.github.io/WILD3810/articles/homework.html">instructions for submission</a> to upload your completed assignment to Canvas</p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#set-up">Set up</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-lincoln-peterson-estimator">The Lincoln-Peterson estimator</a></li>
      </ul>
</li>
      <li>
<a href="#exercise-2-the-schnabel-method">Exercise 2: The Schnabel method</a><ul class="nav nav-pills nav-stacked">
<li><a href="#properties-of-the-lincoln-peterson-estimator">Properties of the Lincoln-Peterson estimator</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
