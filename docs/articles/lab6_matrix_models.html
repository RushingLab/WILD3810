<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modeling population dynamics using matrix projection models • WILD3810</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Modeling population dynamics using matrix projection models">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WILD3810</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2021.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Lecture0/Lecture0.html">Lecture 0: Introduction to WILD3810</a>
    </li>
    <li>
      <a href="../articles/Lecture1/Lecture1.html">Lecture 1: Introduction to population ecology</a>
    </li>
    <li>
      <a href="../articles/Lecture2/lecture2.html">Lecture 2: Abundance</a>
    </li>
    <li>
      <a href="../articles/Lecture3/lecture3.html">Lecture 3: Density-independent population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture4/Lecture4.html">Lecture 4: Stochasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture5/Lecture5.html">Lecture 5: Density-dependent population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture6/lecture6.html">Lecture 6: Dynamics of small populations</a>
    </li>
    <li>
      <a href="../articles/Lecture7/Lecture7.html">Lecture 7: Life tables</a>
    </li>
    <li>
      <a href="../articles/Lecture8/Lecture8.html">Lecture 8: Survival estimation</a>
    </li>
    <li>
      <a href="../articles/Lecture9/Lecture9.html">Lecture 9: Reproduction</a>
    </li>
    <li>
      <a href="../articles/Lecture10/Lecture10.html">Lecture 10: Matrix population models</a>
    </li>
    <li>
      <a href="../articles/Lecture11/Lecture11.html">Lecture 11: Stage-structured populations</a>
    </li>
    <li>
      <a href="../articles/Lecture12/Lecture12.html">Lecture 12: Reproductive value, sensitivity, and elasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture13/Lecture13.html">Lecture 13: Life history variation</a>
    </li>
    <li>
      <a href="../articles/Lecture14/Lecture14.html">Lecture 14: Metapopulation dynamics</a>
    </li>
    <li>
      <a href="../articles/Lecture15/Lecture15.html">Lecture 15: Metapopulation dynamics II</a>
    </li>
    <li>
      <a href="../articles/Lecture16/Lecture16.html">Lecture 16: Source-sink dynamics</a>
    </li>
    <li>
      <a href="../articles/Lecture17/Lecture17.html">Lecture 17: Interspecific interactions</a>
    </li>
    <li>
      <a href="../articles/Lecture18/Lecture18.html">Lecture 18: Interspecific interactions: Predation</a>
    </li>
    <li>
      <a href="../articles/Lecture19/Lecture19.html">Lecture 19: Interspecific interactions: Predation, part II</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab0.html">Lab 0a: Introduction to R and R Markdown</a>
    </li>
    <li>
      <a href="../articles/rmarkdown_intro.html">Lab 0b: Introduction to R Markdown</a>
    </li>
    <li>
      <a href="../articles/lab1.html">Lab 1: Introduction to R (cont.)/Abundance estimation</a>
    </li>
    <li>
      <a href="../articles/lab2.html">Lab 2: Introduction to R/Modeling population growth</a>
    </li>
    <li>
      <a href="../articles/lab3.html">Lab 3: Modeling population growth (continued)</a>
    </li>
    <li>
      <a href="../articles/lab4.html">Lab 4: Population viability analysis</a>
    </li>
    <li>
      <a href="../articles/lab5_life_tables.html">Lab 5: Creating and interpreting a life table</a>
    </li>
    <li>
      <a href="../articles/lab6_matrix_models.html">Lab 6: Modeling population dynamics using matrix projection models</a>
    </li>
    <li>
      <a href="../articles/lab7_tree_harvest.html">Lab 7: Applications of matrix population models - Sustainable tree harvest</a>
    </li>
    <li>
      <a href="../articles/lab8_metapopulation_dynamics.html">Lab 8: Metapopulation dynamics</a>
    </li>
    <li>
      <a href="../articles/lab9_source-sink.html">Lab 9: Source-sink dynamics</a>
    </li>
    <li>
      <a href="../articles/lab10_competition.html">Lab 10: Competition</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/homework.html">
    <span class="fas fa fas fa-pencil-square-o"></span>
     
    Assignments
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lab6_matrix_models_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="lab6_matrix_models_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="lab6_matrix_models_files/anchor-sections-1.0/anchor-sections.js"></script><script src="lab6_matrix_models_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Modeling population dynamics using matrix projection models</h1>
                        <h4 class="author">WILD3810: Plant and animal populations</h4>
            
      
      
      <div class="hidden name"><code>lab6_matrix_models.Rmd</code></div>

    </div>

    
    
<p>In this lab, you will build a matrix population model from published demographic data. This lab will help get you started on how to build the matrix and explore its properties. You will then complete the exercise as part of this week’s homework assignment. If you complete the entire assignment during lab, that is fine. Otherwise, you will need to complete the assignment on your own.</p>
<hr>
<p><strong>Objectives</strong></p>
<ul>
<li><p>Build a matrix population model using published demographic data</p></li>
<li><p>Practice adding data to a matrix using <code>for</code> loops</p></li>
<li><p>Practice visualizing data using <code>ggplot2</code></p></li>
<li>
<p><code>R</code> functions used in this exercise:</p>
<ul>
<li><code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/colSums.html">rowSums()</a></code></li>
</ul>
</li>
</ul>
<hr>
<div id="set-up" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up" class="anchor"></a>Set up</h1>
<ol style="list-style-type: decimal">
<li><p>Log in to R Studio Cloud</p></li>
<li><p>Create a new project called <code>LastnameFirstname-Lab6</code></p></li>
</ol>
<hr>
<p><strong>Note</strong>: You will use the homework 6 template to complete the rest of this lab activity. You can copy the code below to your assignment template to start the assignment. However, you <strong>do not</strong> need to copy code the prints objects, only the code the creates or manipulates the objects.</p>
<hr>
<ol start="3" style="list-style-type: decimal">
<li>
<p>Create a new R Markdown file from the Homework-4 template:</p>
<p>3a) Click <code>File -&gt; New File -&gt; R Markdown</code></p>
<p>3b) Click <code>From Template</code> and scroll down to <code>WILD3810-Homework6</code></p>
<p>3c) In the <code>Name</code> box, type <code>LastnameFirstname-Homework6</code></p>
<p>3d) Click <code>Ok</code></p>
</li>
<li>
<p>Ensure that you can <code>Knit</code> the file</p>
<p>4a) Change “YOUR NAME HERE” in the header section to your name</p>
<p>4b) Click <code>Knit</code> to make sure you can knit the .Rmd file</p>
</li>
<li><p>Follow along with the instructions below to complete the assignment</p></li>
</ol>
<div id="modeling-the-dynamics-of-a-long-lived-tropical-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#modeling-the-dynamics-of-a-long-lived-tropical-tree" class="anchor"></a>Modeling the dynamics of a long-lived tropical tree</h2>
<p>The Choco palm (<em>Astrocaryum mexicanum</em>) is an abundant medium-sized (maximum 10 m tall) understory tree native to rainforests in Mexico and Central America.</p>
<div class="figure" style="text-align: center">
<img src="https://upload.wikimedia.org/wikipedia/commons/b/b0/Astrocaryum_mexicanum_-_Marie_Selby_Botanical_Gardens_-_Sarasota%2C_Florida_-_DSC01156.jpg" alt="Astrocaryum_mexicanum. Photo courtesy of Daderot  via Wikicommons" width="75%"><p class="caption">
Astrocaryum_mexicanum. Photo courtesy of Daderot via Wikicommons
</p>
</div>
<p>Between 1975 and 1981, researchers from the Universidad Nacional Autonoma de Mexico studied the demography of this species on 6 plots located within the Los Tuxlas biological field station in the state of Veracruz, MX<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. The plots were located in mature tracts of forest with no signs of recent disturbance. At the beginning of the study, each individual tree in each plot was classified as an infant (1-8 years old), juvenile (8-5 years old), immature (non-reproductive, 16-25 years old), or mature (older than 25) based on size and leaf production. Additionally, each tree was marked and mapped. Survivorship was estimated by tracking each marked individual at 6 month (infants) or 12 month intervals. The researchers also recorded leaf and trunk growth to estimate the proportion of individuals that transitioned to the next stage during each interval. Information on fecundity was obtained by recording the number of infructescences and fruits for each reproducing individual. Estimates of the stage-specific vital rates are provided in the table below.</p>
<table class="table table">
<thead><tr>
<th style="text-align:center;">
Stage
</th>
<th style="text-align:center;">
Survival
</th>
<th style="text-align:center;">
Growth
</th>
<th style="text-align:center;">
Fecundity
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Fruit
</td>
<td style="text-align:center;">
0.0000
</td>
<td style="text-align:center;">
0.0367
</td>
<td style="text-align:center;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:center;">
Infant
</td>
<td style="text-align:center;">
0.8540
</td>
<td style="text-align:center;">
0.0117
</td>
<td style="text-align:center;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:center;">
Juvenile
</td>
<td style="text-align:center;">
0.9188
</td>
<td style="text-align:center;">
0.0530
</td>
<td style="text-align:center;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:center;">
Immature
</td>
<td style="text-align:center;">
0.9517
</td>
<td style="text-align:center;">
0.0390
</td>
<td style="text-align:center;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 1
</td>
<td style="text-align:center;">
0.9093
</td>
<td style="text-align:center;">
0.0760
</td>
<td style="text-align:center;">
0.1767
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 2
</td>
<td style="text-align:center;">
0.8810
</td>
<td style="text-align:center;">
0.1030
</td>
<td style="text-align:center;">
1.8650
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 3
</td>
<td style="text-align:center;">
0.8817
</td>
<td style="text-align:center;">
0.1150
</td>
<td style="text-align:center;">
8.3033
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 4
</td>
<td style="text-align:center;">
0.8660
</td>
<td style="text-align:center;">
0.1160
</td>
<td style="text-align:center;">
12.4050
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 5
</td>
<td style="text-align:center;">
0.8868
</td>
<td style="text-align:center;">
0.1010
</td>
<td style="text-align:center;">
15.6183
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 6
</td>
<td style="text-align:center;">
0.8490
</td>
<td style="text-align:center;">
0.1310
</td>
<td style="text-align:center;">
20.1120
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 7
</td>
<td style="text-align:center;">
0.8377
</td>
<td style="text-align:center;">
0.1290
</td>
<td style="text-align:center;">
18.2733
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 8
</td>
<td style="text-align:center;">
0.8605
</td>
<td style="text-align:center;">
0.1170
</td>
<td style="text-align:center;">
22.0033
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 9
</td>
<td style="text-align:center;">
0.8767
</td>
<td style="text-align:center;">
0.0880
</td>
<td style="text-align:center;">
20.9017
</td>
</tr>
<tr>
<td style="text-align:center;">
Mature 10
</td>
<td style="text-align:center;">
0.9990
</td>
<td style="text-align:center;">
0.0000
</td>
<td style="text-align:center;">
11.9000
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>1</sup> Survival is the probability that in individual currently in stage i survives and remains in stage i
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>2</sup> Growth is the probability that in individual currently in stage i survives and grows to stage i + 1
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>3</sup> Fecundity is the product of the probability of reproduction and the number of fruits per reproductive individual
</td>
</tr>
</tfoot>
</table>
<p>You will use these estimates to build a matrix population model for <em>Astrocaryum mexicanum</em>.</p>
<div id="estimating-relevant-vital-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#estimating-relevant-vital-rates" class="anchor"></a>Estimating relevant vital rates</h3>
<p>Your goal is to convert the values in the above table into the relevant entries of a matrix that describes stage-specific demographic rates.</p>
<hr>
<p><strong>Before moving on, answer question 2 on the homework file</strong></p>
<hr>
<p>To create the matrix, you will need to take the vital rates in the table above and combine them to create the relevant matrix.</p>
</div>
<div id="creating-matrices-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-matrices-in-r" class="anchor"></a>Creating matrices in <code>R</code>
</h3>
<p>So far in this class, we have learned to create vector objects and data frames. For this lab, we will need to create a different type of object - matrices. Creating a matrix can be done using the <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> function. This function takes a vector that includes all of the values that make up the matrix (remember - to create a vector, use the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function) as well as the number of rows and columns that define the matrix. For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>(A &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>              <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>              <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; [1,] 0.00  2.0    4</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; [2,] 0.25  0.0    0</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; [3,] 0.00  0.5    0</span></span></code></pre></div>
<p>Notice that the values within the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function form a single vector even though I entered the values on three lines. Putting them on different lines is not necessary but does make it easier to keep track of how the final matrix is organized (in this case, a <span class="math inline">\(3x3\)</span> matrix with values <code>0, 2, 4</code> on the first row, <code>0.25, 0, 0</code> on the second row, and <code>0, 0.5, 0</code> on the third row). One important behavior of this function is that by default, <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> will create the matrix <em>by column</em>. We entered our data as rows so we need to specify <code>byrow = TRUE</code>. If we did not use this option, we would get:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>(A &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>,</span>
<span id="cb2-2"><a href="#cb2-2"></a>              <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb2-3"><a href="#cb2-3"></a>              <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; [1,]    0 0.25  0.0</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; [2,]    2 0.00  0.5</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; [3,]    4 0.00  0.0</span></span></code></pre></div>
<p>Not the matrix we wanted! Be very careful about this option when you are creating matrices of your own.</p>
<p>In your homework template, enter the code necessary to create a matrix describing the demographic rates of <em>Astrocaryum mexicanum</em> (call this matrix <code>A</code>) and answer question 3. <strong>Note that your code should not be placed inside of parentheses like the code above. This is done so that the resulting matrix was printed to the console when created. You do not need to print the matrix in the homework template</strong></p>
</div>
</div>
<div id="projecting-the-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#projecting-the-matrix" class="anchor"></a>Projecting the matrix</h2>
<p>With the matrix now created, you can predict the future dynamics of the hypothetical <em>Astrocaryum mexicanum</em> population. At this point, we don’t know how long it will take the population to reach equilibrium so we’ll project the matrix for 250 years just to be safe:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>nYears &lt;-<span class="st"> </span>?</span></code></pre></div>
<p>Next, we’ll create a matrix to store the stage-specific abundances in each year. That means the matrix will need to have one row for each year and one column for each stage:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>N &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> ?, <span class="dt">ncol =</span> ?)</span></code></pre></div>
<p>Next, we need to fill in the initial population size. Let’s assume that in the first year there are 1400 individuals, with 74% in the fruit stage and the remaining split evenly between the other 13 stages. We can enter these values as a single vector and use the <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code> function to avoid a lot of typing:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>N[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(?, <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(?, ?))</span></code></pre></div>
<p>Copy the three lines of code above into the chunk called <code>init_N</code> and replace the question marks with the correct values.</p>
<p>Now you are ready to simulate future population sizes. You will need to do this using a <code>for</code> loop. Remember that:</p>
<p><span class="math display">\[\large \mathbf N_{t + 1} = \mathbf A \times \mathbf N_t\]</span></p>
<p>where <span class="math inline">\(\mathbf N_{t}\)</span> is the matrix containing the current stage-specific abundance and <span class="math inline">\(\mathbf A\)</span> is the population matrix.</p>
<hr>
<p><strong>Matrix multiplication in <code>R</code></strong>: To do matrix multiplication in <code>R</code>, you will need a special function: <code><a href="https://rdrr.io/r/base/matmult.html">%*%</a></code>. Remember to put your matrices in the correct order! (<span class="math inline">\(\mathbf A \times \mathbf N\)</span> is <strong>not</strong> the same as <span class="math inline">\(\mathbf N \times \mathbf A\)</span>)</p>
<hr>
<p>Complete the code below to run your loop:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>?){</span>
<span id="cb6-2"><a href="#cb6-2"></a>  N[t,] &lt;-<span class="st"> </span>?</span>
<span id="cb6-3"><a href="#cb6-3"></a>}</span></code></pre></div>
</div>
<div id="examining-the-growth-of-astrocaryum-mexicanum" class="section level2">
<h2 class="hasAnchor">
<a href="#examining-the-growth-of-astrocaryum-mexicanum" class="anchor"></a>Examining the growth of <em>Astrocaryum mexicanum</em>
</h2>
<p>Now that you have projected population size, you can examine the dynamics of this population.</p>
<div id="transient-dynamics" class="section level3">
<h3 class="hasAnchor">
<a href="#transient-dynamics" class="anchor"></a>Transient dynamics</h3>
<p>Because we started the population at a random stage distribution, your population likely underwent some period of transient dynamics. To examine how long these dynamics lasted, you first need to create a data frame with the stage-specific abundances:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>N_df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">Year =</span> <span class="dv">1</span><span class="op">:</span>nYears,</span>
<span id="cb7-2"><a href="#cb7-2"></a>                   <span class="dt">N =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(N),</span>
<span id="cb7-3"><a href="#cb7-3"></a>                   <span class="dt">Stage =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Fruit"</span>, <span class="st">"Infant"</span>, <span class="st">"Juvenile"</span>, <span class="st">"Immature"</span>, <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Mature "</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))), <span class="dt">each =</span> nYears))</span></code></pre></div>
<p>Now complete the following code to plot the <strong>log of N</strong> for each stage:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ?, <span class="kw">aes</span>(<span class="dt">x =</span> ?, <span class="dt">y =</span> ?, <span class="dt">color =</span> ?)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_path</span>() <span class="op">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#E41A1C"</span>, <span class="st">"#79577C"</span>, <span class="st">"#3C899E"</span>, <span class="st">"#49A75A"</span>, </span>
<span id="cb8-3"><a href="#cb8-3"></a>                                <span class="st">"#6F8273"</span>, <span class="st">"#9F5196"</span>, <span class="st">"#DF6F32"</span>, <span class="st">"#FFA60F"</span>, </span>
<span id="cb8-4"><a href="#cb8-4"></a>                                <span class="st">"#FFF52F"</span>, <span class="st">"#CFA42D"</span>, <span class="st">"#B25C3F"</span>, <span class="st">"#E4779C"</span>, </span>
<span id="cb8-5"><a href="#cb8-5"></a>                                <span class="st">"#D28AB0"</span>,  <span class="st">"#999999"</span>))</span></code></pre></div>
<p>After you have made the plot, answer questions 4a and 4b in the homework.</p>
</div>
<div id="stable-stage-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#stable-stage-distribution" class="anchor"></a>Stable stage distribution</h3>
<p>Next, we’ll use the final population size to estimate the stable stage distribution of the population. To do this, first subset the stage-specific abundances in the final year of the simulation:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>nFinal &lt;-<span class="st"> </span>N[?,]</span></code></pre></div>
<p>To estimate the proportion of the population in each stage, we can simply divide the <code>nFinal</code> vector by the total number of individuals in the population. How can you compute the total population size from the <code>nFinal</code> vector (hint - use a built-in function we learned earlier in the semester)? Once you have computed <code>Ntot</code>, estimate the stable stage distribution:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>Ntot &lt;-<span class="st"> </span>?</span>
<span id="cb10-2"><a href="#cb10-2"></a>ssd &lt;-<span class="st"> </span>?<span class="op">/</span>?</span></code></pre></div>
<p>In your homework template, create the code necessary to estimate the stage distribution in each year and answer questions 4a &amp; 4b.</p>
</div>
<div id="asymptotic-large-lambda" class="section level3">
<h3 class="hasAnchor">
<a href="#asymptotic-large-lambda" class="anchor"></a>Asymptotic <span class="math inline">\(\large \lambda\)</span>
</h3>
<p>Next, estimate the asymptotic growth rate. Remember, at equilibrium the growth rate should be the same in every year and can be calculated as:</p>
<p><span class="math display">\[\LARGE \lambda = \frac{N_{t+1}}{N_t}\]</span> You already have the total population size at the end of the simulation (year 250), which we will use as <span class="math inline">\(N_{t+1}\)</span> in the equation above. So now we just need to estimate <span class="math inline">\(N_{t}\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>nt &lt;-<span class="st"> </span>N[?,]</span>
<span id="cb11-2"><a href="#cb11-2"></a>Nt &lt;-<span class="st"> </span>?</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>lambda &lt;-<span class="st"> </span>?<span class="op">/</span>?</span></code></pre></div>
<p>In your homework template, create the code necessary to estimate <span class="math inline">\(\lambda\)</span> and answer questions 6a &amp; 6b.</p>
</div>
<div id="population-inertia" class="section level3">
<h3 class="hasAnchor">
<a href="#population-inertia" class="anchor"></a>Population inertia</h3>
<p>Now that you know the SSD for this population, simulate the dynamics of a second population that also starts with 1400 individuals but at the SSD. Copy the necessary code from above and paste it into the chunk titled <code>N_SSD</code>. Next, change the names of the objects so that the original simulation results aren’t lost (call <code>N</code> <code>Nssd</code>). Finally, change the initial population size to match the SSD you estimated above (hint: you can get a vector of abundances that correspond to the SSD by multiplying 1400 by the <code>ssd</code> object)</p>
<p>Once you have completed the new simulation, use the code below to create a single data frame with the total population sizes in each year from both simulations:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>N_tot &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(N)</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>N_tot_ssd &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(Nssd)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a>N_ssd_df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">Year =</span> <span class="dv">1</span><span class="op">:</span>nYears,</span>
<span id="cb12-6"><a href="#cb12-6"></a>                       <span class="dt">N =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(N_tot, N_tot_ssd),</span>
<span id="cb12-7"><a href="#cb12-7"></a>                       <span class="dt">Initial =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Fruit"</span>, <span class="st">"SSD"</span>), <span class="dt">each =</span> nYears))</span></code></pre></div>
<p>Finally, use <code>ggplot2</code> to plot the log population size across years for each simulated population. Make sure the color of each line corresponds to the initial conditions and then answer questions 7a-7c.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Data used in this project are from Pinero D., Martinez-Ramos M., and Sarukhan J. (1984). A Population Model of Astrocaryum Mexicanum and a Sensitivity Analysis of its Finite Rate of Increase. <em>Journal of Ecology</em>, 72, 977-991.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#set-up">Set up</a><ul class="nav nav-pills nav-stacked">
<li><a href="#modeling-the-dynamics-of-a-long-lived-tropical-tree">Modeling the dynamics of a long-lived tropical tree</a></li>
      <li><a href="#projecting-the-matrix">Projecting the matrix</a></li>
      <li><a href="#examining-the-growth-of-astrocaryum-mexicanum">Examining the growth of <em>Astrocaryum mexicanum</em></a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
