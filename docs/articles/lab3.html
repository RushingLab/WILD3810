<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 3: Population viability analysis • WILD3810</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 3: Population viability analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WILD3810</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2019.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Lecture0/Lecture0.html">Lecture 0: Introduction to WILD3810</a>
    </li>
    <li>
      <a href="../articles/Lecture1/Lecture1.html">Lecture 1: Introduction to population ecology</a>
    </li>
    <li>
      <a href="../articles/Lecture2/lecture2.html">Lecture 2: How many are there? Estimating abundance</a>
    </li>
    <li>
      <a href="../articles/Lecture3/lecture3.html">Lecture 3: Introduction to population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture4/Lecture4.html">Lecture 4: Density-dependent population growth</a>
    </li>
    <li>
      <a href="../articles/Lecture6/lecture6.html">Lecture 6: Stochasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture7/Lecture7.html">Lecture 7: Dynamics of small populations</a>
    </li>
    <li>
      <a href="../articles/Lecture8/Lecture8.html">Lecture 8: Life Tables</a>
    </li>
    <li>
      <a href="../articles/Lecture9/Lecture9.html">Lecture 9: Survival estimation</a>
    </li>
    <li>
      <a href="../articles/Lecture10/Lecture10.html">Lecture 10: Reproduction</a>
    </li>
    <li>
      <a href="../articles/Lecture11/Lecture11.html">Lecture 11: Introduction to matrix projection models</a>
    </li>
    <li>
      <a href="../articles/Lecture12/Lecture12.html">Lecture 12: Stage-structured population models</a>
    </li>
    <li>
      <a href="../articles/Lecture13/Lecture13.html">Lecture 13: Reproductive value, sensitivity, and elasticity</a>
    </li>
    <li>
      <a href="../articles/Lecture14/Lecture14.html">Lecture 14: Life history variation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab1.html">Lab 1a: Introduction to R and mark-recapture</a>
    </li>
    <li>
      <a href="../articles/rmarkdown_intro.html">Lab 1b: Introduction to R Markdown</a>
    </li>
    <li>
      <a href="../articles/lab2.html">Lab 2: Modeling population dynamics</a>
    </li>
    <li>
      <a href="../articles/lab3.html">Lab 3: Population viability analysis</a>
    </li>
    <li>
      <a href="../articles/life_table.html">Lab 4: Building and interpreting static life tables</a>
    </li>
    <li>
      <a href="../articles/matrix_models.html">Lab 5: Modeling population dynamics using matrix projection models</a>
    </li>
    <li>
      <a href="../articles/matrix_models2.html">Lab 6: Modeling population dynamics using matrix projection models, part 2</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/homework.html">
    <span class="fas fa fas fa-pencil-square-o"></span>
     
    Assignments
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Lab 3: Population viability analysis</h1>
            <h3 class="subtitle">WILD3810: Plant and animal populations</h3>
                        <h4 class="author">Spring 2019</h4>
            
      
      
      <div class="hidden name"><code>lab3.Rmd</code></div>

    </div>

    
    
<p>In this lab, you will learn about using population viability analysis (PVA) to predict the future dynamics of populations that are subject to stochastic variation in birth and death rates.</p>
<hr>
<p><strong>Objectives</strong></p>
<ul>
<li><p>Predict extinction risk using population viability analysis</p></li>
<li><p>Build intuition about the ecological factors that influence extinction risk</p></li>
<li>
<code>R</code> functions used in this exercise:
<ul>
<li><code><a href="../reference/pva.html">WILD3810::pva()</a></code></li>
</ul>
</li>
</ul>
<hr>
<div id="setting-up-the-lab" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-up-the-lab" class="anchor"></a>Setting up the lab</h2>
<p>In order to organize your code and files for this homework assignment, start by creating a new project:</p>
<ol style="list-style-type: decimal">
<li><p>Open <code>RStudio</code></p></li>
<li><p>Click <code>File -&gt; New Project</code></p></li>
</ol>
<p><img src="figs/new_file.png" width="100%"></p>
<ol start="3" style="list-style-type: decimal">
<li>Click <code>New Directory</code>
</li>
</ol>
<p><img src="figs/project_options.png" width="100%"></p>
<ol start="4" style="list-style-type: decimal">
<li>Click <code>New Project</code>
</li>
</ol>
<p><img src="figs/new_project2.png" width="100%"></p>
<ol start="5" style="list-style-type: decimal">
<li>Name the project <code>PVA</code> and create it within your <code>WILD3810</code> folder (click <code>Browse</code> and navigate to this folder if necessary)</li>
</ol>
<p><img src="figs/pva_project.png" width="100%"></p>
<ol start="6" style="list-style-type: decimal">
<li><p>Click <code>Create project</code></p></li>
<li><p>Click <code>File -&gt; New File -&gt; R Script</code></p></li>
<li><p>Save this script as <code>PVA_lab.R</code> (you will not need to turn in this script but saving it here will ensure that you can reference today’s lab activities to help study for the exam)</p></li>
<li><p>Make sure you have the most update-to-date version of <code>WILD3810</code> by running:</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"RushingLab/WILD3810"</span>)</code></pre></div>
</div>
<div id="simulating-stochastic-population-dynamcs" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-stochastic-population-dynamcs" class="anchor"></a>Simulating stochastic population dynamcs</h2>
<p>The <code>WILD3810</code> package includes an <code>R</code> function that simulates the dynamics of a user-defined number of populations that are subject to both environmental and demographic stochasticity. This function has a number of parameters that you can change to alter the deterministic and stochastic processes that govern population growth. In this lab, you will selectively change several of these parameters to see how each influences extinction risk.</p>
<p>Before getting into the ecological principles, let’s see how the function works and what it returns. The function requires several arguments:</p>
<ul>
<li><p><code>N0</code>: the initial population size</p></li>
<li><p><code>number.of.years</code>: the number of years to simulate population growth</p></li>
<li><p><code>r0</code>: the intrinsic rate of population growth</p></li>
<li><p><code>variance.r</code>: the magnitude of environmental stochasticity on the population growth</p></li>
<li><p><code>K</code>: the carrying capacity (this is optional; if you do not provide <code>K</code>, the function assumes density-independent growth. For this lab, we will only focus on density-dependent growth)</p></li>
</ul>
<p>In the R script you just created, run the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(WILD3810)
sim_test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">5</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.075</span>, <span class="dt">K =</span> <span class="dv">50</span>)</code></pre></div>
<p><img src="lab3_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>The function returns two types of output. Most obviously, the function returns three plots:</p>
<ol style="list-style-type: decimal">
<li><p>The top left plot shows the predicted (line) and actual (points) growth rates <span class="math inline">\(r\)</span> as a function of population size</p></li>
<li><p>The top right plot shows the change in abundance over time for all simulated populations</p></li>
<li><p>The bottom plot shows the cumulative probability of extinction over time</p></li>
</ol>
<p>In addition to the figures, the newly created <code>sim_test</code> object is a data frame that contains some useful summaries of the simulation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_test</code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
nYears
</th>
<th style="text-align:right;">
N0
</th>
<th style="text-align:right;">
r0
</th>
<th style="text-align:right;">
variance.r
</th>
<th style="text-align:left;">
density.dependent
</th>
<th style="text-align:right;">
K
</th>
<th style="text-align:right;">
theta
</th>
<th style="text-align:right;">
prob.extinct
</th>
<th style="text-align:right;">
median.time.to.ext
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.056
</td>
<td style="text-align:right;">
5.5
</td>
</tr></tbody>
</table>
<p>This table returns some of the input parameters (<code>nYears</code>, <code>N0</code>, <code>r0</code>, <code>variance.r</code>) as well as summaries about the type of model (density dependent or independent) and carrying capacity (if density-dependent). In addition, the output include two important summary statistics:</p>
<ol style="list-style-type: decimal">
<li><p><code>prob.extinct</code>: the estimated probability of extinction over the simulated time frame</p></li>
<li><p><code>median.time.to.ext</code>: of the populations that went extinct, the median number of years to extinction</p></li>
</ol>
<p>In the remainder of this lab, we will vary the input parameters and use the output of the function to visually understand the ecological factors that influence extinction risk.</p>
</div>
<div id="factor-1-growth-rate" class="section level2">
<h2 class="hasAnchor">
<a href="#factor-1-growth-rate" class="anchor"></a>Factor 1: Growth rate</h2>
<p>First let’s see how the expected low-density growth rate (<code>r0</code>) influences extinction risk. To do this, we will simulate several data sets that vary <code>r0</code> but are the same in every other way. To start, change <code>r0</code> to 0.1, leaving the other parameters the same as above.</p>
<hr>
<p><strong>Prediction</strong>: Do you expect extinction risk to be higher, lower, or the same than the previous simulation? Why?</p>
<hr>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_r.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">5</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.1</span>, <span class="dt">variance.r =</span> <span class="fl">0.075</span>, <span class="dt">K =</span> <span class="dv">50</span>)</code></pre></div>
<p>Were you correct?</p>
<p>Now make <span class="math inline">\(r\)</span> bigger. Choose a value of <span class="math inline">\(r0 &gt; 0.4\)</span>. Call the new object <code>sim_r.2</code>.</p>
<hr>
<p><strong>Prediction</strong>: How will a larger growth rate influence extinction risk?</p>
<hr>
<p>Finally, make <span class="math inline">\(r\)</span> smaller. Run simulations called <code>sim_r.3</code> with <span class="math inline">\(r = 0\)</span> and <code>sim_r.4</code> with <span class="math inline">\(r &lt; 0\)</span>.</p>
<hr>
<p><strong>Interpretation</strong>: What happens to populations that have negative or positive values of <code>r0</code>?</p>
<p>How does the time to extinction change as a function of <span class="math inline">\(r\)</span>?</p>
<hr>
<p>Before moving on, use the <code>dplyr</code> function <code>bind_rows</code> to create a new data frame that contains all of the simulations created in this section. Call the new data frame <code>sim_r</code>.</p>
</div>
<div id="factor-2-carrying-capacity" class="section level2">
<h2 class="hasAnchor">
<a href="#factor-2-carrying-capacity" class="anchor"></a>Factor 2: Carrying capacity</h2>
<p>Next, let’s vary <code>K</code>. To start, leave the other options the same as in <code>sim_r.1</code> but with <code>K=150</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_K.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">5</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.1</span>, <span class="dt">variance.r =</span> <span class="fl">0.075</span>, <span class="dt">K =</span> <span class="dv">150</span>)</code></pre></div>
<p>What happened to extinction probability relative to <code>K = 50</code>? To make sure the previous result wasn’t a fluke, increase <code>K</code> again and see if the pattern holds:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_K.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">5</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.1</span>, <span class="dt">variance.r =</span> <span class="fl">0.075</span>, <span class="dt">K =</span> <span class="dv">500</span>)</code></pre></div>
<hr>
<p><strong>Interpretation</strong>: Why did larger <code>K</code> influence extinction probability? Did extinction probability continue to change as <code>K</code> increased? Why or why not?</p>
<p>Why do the populations go above <code>K</code> if that is the maximum abundance the environment can support?</p>
<p>Why do the populations show predictable patterns of increase and decrease around <code>K</code>?</p>
<hr>
<p>Before moving on, use the <code>dplyr</code> function <code>bind_rows</code> to create a new data frame that contains all of the simulations created in this section. Call the new data frame <code>sim_K</code>.</p>
</div>
<div id="factor-3-variability-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#factor-3-variability-in-r" class="anchor"></a>Factor 3: Variability in <code>r</code>
</h2>
<p>Now let’s change <code>variance.r</code>. First, create a simulation with no environmental stochasticity:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_var_r.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">5</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                   <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="dv">0</span>, <span class="dt">K =</span> <span class="dv">150</span>)</code></pre></div>
<p>You can see if the top left figure that the actual growth rates in each year were exactly equal to the predicted values - no stochasticity in the mean population growth rate. Yet the population size figure still shows populations going up and down. Why is that?</p>
<p>Now increase <code>variance.r</code> relative to the earlier simulations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_var_r.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">5</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                   <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.1</span>, <span class="dt">K =</span> <span class="dv">150</span>)</code></pre></div>
<p>What happened to extinction risk? Again, let’s see if that pattern holds:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_var_r.<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">5</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                   <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>)</code></pre></div>
<p>Run a few more simulations with increasing values of <code>variance.r</code>. Does the general pattern you saw on the previous simulations hold?</p>
<hr>
<p><strong>Interpretation</strong>: Why does increasing stochasticity influence probability of extinction?</p>
<hr>
<div id="factor-3b-demographic-stochasticity" class="section level3">
<h3 class="hasAnchor">
<a href="#factor-3b-demographic-stochasticity" class="anchor"></a>Factor 3b: Demographic stochasticity</h3>
<p>Before moving on from the question of stochasticity, let’s look more closely at the role of demographic stochasticity by removing environmental stochasticity from the model (<code>variance.r = 0</code>) and observing how demographic stochasticity influences extinction risk at different carrying capacities. Start with a large K (<code>K=500</code>):</p>
<hr>
<p><strong>Prediction</strong>: At large sizes, do you expect demographic stochasticity to have important consequences for extinction risk?</p>
<hr>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_var_r.<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">500</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="dv">0</span>, <span class="dt">K =</span> <span class="dv">500</span>)</code></pre></div>
<p>Now change <code>K=50</code>:</p>
<hr>
<p><strong>Prediction</strong>: Will the extinction risk of this population be greater than 0?</p>
<hr>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_var_r.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">50</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.1</span>, <span class="dt">variance.r =</span> <span class="dv">0</span>, <span class="dt">K =</span> <span class="dv">50</span>)</code></pre></div>
<p>Finally, <code>N0=10</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_var_r.<span class="dv">6</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">10</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.1</span>, <span class="dt">variance.r =</span> <span class="dv">0</span>, <span class="dt">K =</span> <span class="dv">10</span>)</code></pre></div>
<hr>
<p><strong>Interpretation</strong>: Why are small populations more vulnerable to demographic stochasticity?</p>
<p>How does <code>r0</code> influence how vulnerable populations are to demographic stochasticity?</p>
<hr>
<p>Before moving on, use the <code>dplyr</code> function <code>bind_rows</code> to create a new data frame that contains all of the simulations created in this section. Call the new data frame <code>sim_var_r</code>.</p>
</div>
</div>
<div id="factor-4-initial-population-size" class="section level2">
<h2 class="hasAnchor">
<a href="#factor-4-initial-population-size" class="anchor"></a>Factor 4: Initial population size</h2>
<p>So far, all of the simulations have been started with very small initial sizes (<code>N0 = 5</code>). Next examine how the initial population size influences extinction risk.</p>
<hr>
<p><strong>Prediction</strong>: How do you predict the probability of extinction will change as initial population size increases?</p>
<hr>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_var_r.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">20</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                   <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>)</code></pre></div>
<p>Were you right?</p>
<p>Increase <code>N0</code> again to make sure it wasn’t a fluke:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_N0.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">50</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>)</code></pre></div>
<p>What if <code>N0 &gt; K</code>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_N0.<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">250</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>)</code></pre></div>
<hr>
<p><strong>Interpretation</strong>: Why does increasing population size influence extinction risk?</p>
<hr>
<p>Before moving on, use the <code>dplyr</code> function <code>bind_rows</code> to create a new data frame that contains all of the simulations you have created so far. Call the new data frame <code>sim_N0</code>.</p>
</div>
<div id="factor-5-strenth-of-density-dependence" class="section level2">
<h2 class="hasAnchor">
<a href="#factor-5-strenth-of-density-dependence" class="anchor"></a>Factor 5: Strenth of density dependence</h2>
<p>Finally, let’s see how the strength of density-dependence influence extinction risk. Remember from <a href="https://rushinglab.github.io/WILD3810/articles/Lecture4/Lecture4.html#1">lecture 4</a> the theta-Ricker growth model:</p>
<p><span class="math display">\[\Large N_{t+1}=N_t e^{\bigg[r_0\bigg(1 - \bigg[\frac{N}{K}\bigg]^\theta\bigg)\bigg]}\]</span></p>
<p>The parameter <span class="math inline">\(\theta\)</span> controls the shape of the density dependence curve. When <span class="math inline">\(\theta &gt; 1\)</span>, <span class="math inline">\(r\)</span> does not respond to <span class="math inline">\(N\)</span> until <span class="math inline">\(N\)</span> is big enough that resources become limiting</p>
<p><img src="lab3_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
<p>If <span class="math inline">\(\theta &lt; 1\)</span>, resources quickly become scarce, and <span class="math inline">\(r\)</span> is suppressed even at low <span class="math inline">\(N\)</span></p>
<p><img src="lab3_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
<p>Let’s see how the shape of the density-dependence curve influences extinction risk. First, let’s explore <span class="math inline">\(\theta &lt; 1\)</span>.</p>
<hr>
<p><strong>Prediction</strong>: Do you expect extinction risk to be higher, lower, or the same than the previous simulation? Why?</p>
<hr>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_theta.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">250</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>, <span class="dt">theta =</span> <span class="fl">0.75</span>)</code></pre></div>
<p>Again, make <span class="math inline">\(\theta\)</span> smaller to see if the pattern holds:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_theta.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">250</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>, <span class="dt">theta =</span> <span class="fl">0.25</span>)</code></pre></div>
<p>Was your prediction correct?</p>
<p>Now try <span class="math inline">\(\theta &gt; 1\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_theta.<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">250</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>, <span class="dt">theta =</span> <span class="fl">1.25</span>)</code></pre></div>
<p>And even larger:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_theta.<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pva.html">pva</a></span>(<span class="dt">N0 =</span> <span class="dv">250</span>, <span class="dt">number.of.years =</span> <span class="dv">100</span>, 
                <span class="dt">r0 =</span> <span class="fl">0.4</span>, <span class="dt">variance.r =</span> <span class="fl">0.2</span>, <span class="dt">K =</span> <span class="dv">150</span>, <span class="dt">theta =</span> <span class="fl">1.75</span>)</code></pre></div>
<p>Before moving on, use the <code>dplyr</code> function <code>bind_rows</code> to create a new data frame that contains all of the simulations created in this section. Call the new data frame <code>sim_dd</code>.</p>
</div>
<div id="on-your-own" class="section level2">
<h2 class="hasAnchor">
<a href="#on-your-own" class="anchor"></a>On your own</h2>
<p>So far, we have only varied one parameter at a time. On your own, play with different combinations of the parameters and see what happens to extinction risk and time to extinction. Before making a change, be sure to think about what you predict will happen and then see if you prediction was correct.</p>
</div>
<div id="putting-it-all-together" class="section level2">
<h2 class="hasAnchor">
<a href="#putting-it-all-together" class="anchor"></a>Putting it all together</h2>
<p>On your own, create a new data frame that contains all of the simulated results (add any that you created in the previou section):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sim_pva &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(sim_test, sim_r, sim_K, sim_var_r, sim_N0, sim_dd)</code></pre></div>
<p>Now create your own plots showing the relationship between extinction probability/time to extinction and the parameters you varied in the simulations. Using the following code as a guide:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(sim_pva, <span class="kw">aes</span>(<span class="dt">x =</span> prob.extinct, <span class="dt">y =</span> variance.r, <span class="dt">size =</span> N0)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
</div>
<div id="homework-3-population-viability-of-the-violet-winged-checkerspot" class="section level1">
<h1 class="hasAnchor">
<a href="#homework-3-population-viability-of-the-violet-winged-checkerspot" class="anchor"></a>Homework 3: Population viability of the violet-winged checkerspot</h1>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The violet-winged checkerspot (<em>Euphydryas fakii</em>) is a made-up butterfly species of high conservation concern to the WILD3810 community. This rare and elusive species is restricted to high-elevation meadows in a small area of Cache County (due to their rarity and extreme beauty, the species is highly sought after in the illegal pet trade. For this reason, the exact location of the remaining populations cannot be provided).</p>
<p>Fortunately, the checkerspot has been the subject of long-term research by scientists at USU. Every year since 1980, researchers have counted all of the adult butterflies in the population (because the patches of suitable habitat are known and small, a complete census is possible). Although never common, the species was relatively abundant throughout the 1980’s and 1990’s. Periodic fires that wiped out most of the species sole host plant did reduce the population size in several years (3 fires occurred during the first 30 years of the study) but the species generally bounced back quickly.</p>
<p>However, in the late 1990’s/early 2000’s, approximately 92% of the historically habitat was destroyed by new housing developments. Destruction of the meadows the species requires to survive and breed led to a predictable decline in abundance. The frequency of severe fires also appears to have increased, with three severe fires occurring in last 8 years alone.</p>
<p><img src="lab3_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>After the initial drop in the population size, a working group made up of elected officials and appointed agency officials was formed to set management objectives and decide on management actions to ensure the long-term persistence of this species. The working group, afraid that setting specific management objectives might set themselves up for failure, decided on two vague objectives:</p>
<ol style="list-style-type: decimal">
<li><p>Ensure high probability that the species will not go extinct in the near future</p></li>
<li><p>Ensure reasonable probability that the species does not drop below the monitoring threshold of 10</p></li>
</ol>
<p>The second objective was created because once the population drops below 10 individuals, it becomes very difficult to find and count individuals. Therefore, maintaining the population above this quasi-extinction threshold was viewed as an important objective for accurately monitoring future population size.</p>
<div id="turning-the-objectives-into-actions" class="section level3">
<h3 class="hasAnchor">
<a href="#turning-the-objectives-into-actions" class="anchor"></a>Turning the objectives into actions</h3>
<p>Because the working group contained no ecologists, the members had to out-source the hard work of actually predicting the future dynamics of the checkerspot. As the agency’s most promising young entomologist and an expert in population viability analysis, you have been asked to conduct a study and provide the working group with a specific recommendation for how to meet the two management objectives.</p>
<p>In order to provide the working group with a scientifically-sound recommendation, you pull together all of the data you can find on the violet-winged checkerspot. These data include:</p>
<ul>
<li>The observed counts of individuals in each year since 1980. These are stored in a data frame which can be accessed directly in <code>R</code>. The data frame contains the <code>Year</code>, abundance (<code>N</code>), and whether the count was conducted before or after the housing developments were built.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"obs_N"</span>)</code></pre></div>
<ul>
<li>
<p>Data from two master’s theses on the birth and death rates before and after the developments were built:</p>
<ul>
<li><p>Before the housing development, a three-year study (1984-1986) counted 260, 484, and 471 births (individuals that were born and survived to the following year). The lower births in 1986 coincided with a fire year. A follow-up study done in 2012-2014 found 12, 17, and 15 individuals born and survived.</p></li>
<li><p>The same studies found that 53, 97, and 628 individuals that were alive in those years did not survive until the next year. The follow up study found that 3 individuals died each year.</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="setting-up-the-assignment" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-up-the-assignment" class="anchor"></a>Setting up the assignment</h2>
<p>From within the RStudio project you just created:</p>
<ol style="list-style-type: decimal">
<li>Click <code>File -&gt; New File -&gt; R Markdown</code>
</li>
</ol>
<p><img src="figs/new_file.png" width="100%"></p>
<ol start="2" style="list-style-type: decimal">
<li>Select <code>From Template</code>; scroll down and select <code>WILD3810-Homework3</code>
</li>
</ol>
<p><img src="figs/from_template.png" width="100%"></p>
<ol start="3" style="list-style-type: decimal">
<li>In the <code>Name</code> box, type <code>LastnameFirstName-Homework3</code>
</li>
</ol>
<p><img src="figs/homework_name.png" width="100%"></p>
<ol start="4" style="list-style-type: decimal">
<li>Click <code>Ok</code>
</li>
</ol>
</div>
<div id="baseline-extinction-risk" class="section level2">
<h2 class="hasAnchor">
<a href="#baseline-extinction-risk" class="anchor"></a>Baseline extinction risk</h2>
<p>Based on the information you learned about the butterfly population dynamics, your first task is to determine the baseline risk of extinction if no management actions are taken. To this, you can use the <code><a href="../reference/baseline_pva.html">baseline_pva()</a></code> function. Use <code>?baseline_pva()</code> to see what arguments this function requires.</p>
<p>Inside the main code chunk of the homework template, use the above data to estimate the parameters required by the <code><a href="../reference/baseline_pva.html">baseline_pva()</a></code> function. Keep in mind:</p>
<ol style="list-style-type: decimal">
<li><p>In that code chunk, create objects that correspond to either values you need in order to estimate the required information (e.g., <code>B_before &lt;- c(260, 484)</code>, <code>pr.fire &lt;- ?/?</code>). You can then use these objects later when predicting extinction risk.</p></li>
<li><p>Remember that the code inserted here needs to stand alone in order for the document to knit. That means you need to load any required packages (using <code><a href="https://www.rdocumentation.org/packages/base/topics/library">library(dplyr)</a></code>) <strong>inside of .Rmd file itself</strong>. Having the package loaded in your current working environment is not enough.</p></li>
<li><p>The carrying capacity in this case refers to <code>K</code> <em>after</em> the housing development was built. You have enough information to estimate this by estimating <code>K</code> <em>before</em> the housing development and then reducing that by the amount of habitat that was lost. Use the <code><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter()</a></code> function from the <code>dplyr</code> package to filter just the observed counts before the housing development. Then estimate <code>K</code> as the mean of those counts</p></li>
<li><p>The baseline birth and death rates as well as the rates in fire years can be estimated from the observed number of births and deaths. Did those rates change before and after the development? Use your best scientific judgement to answer this. Were those rates different in fire years? To estimate these rates, create vectors that hold the observed births or deaths and the observed abundance in each of those years. Then estimate the mean birth rate or death rate from these objects.</p></li>
<li><p>The function requires an estimate of the fire frequency. Think of this as the <em>probability</em> of a fire any given year. Did this frequency change before and after the development?</p></li>
<li><p>The working group was vague about the time frame and acceptable extinction probability. You will have to decide what time frame and risk correspond to “near future” and “high probability” (or “reasonable probability” for the monitoring threshold). In your recommendation, you will need state the time frane you chose and justify this choice.</p></li>
</ol>
<p>Once you have code that creates all of the objects you need to run the function, you can run it using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">base_pva &lt;-<span class="st"> </span><span class="kw"><a href="../reference/baseline_pva.html">baseline_pva</a></span>(...)</code></pre></div>
<p>Subsituting <code>...</code> for the required arguments.</p>
<p>In addition to the figure showing the predicted dynamics of the simulated populations, the <code>base_pva</code> object is a data frame containing the final abundance of each simulated population, whether the population ended below the extinction threshold, and the number of years it took for the “extinct” populations to go extinct. You can use this object to estimate the probability of quasi-extinction and median time to extinction:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(base_pva<span class="op">$</span>Extinct)
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/median">median</a></span>(base_pva<span class="op">$</span>year0, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="co"># Note that you need the `na.rm = TRUE` for this function to work</span></code></pre></div>
<hr>
<p><strong>Note that</strong> within the text of your .Rmd file (i.e., inside your actual recommendation) you can access these values by inserting the <code>R</code> code as follows: <code>`r mean(base_pva$Extinct)`</code> (including the single backticks before and after the code!), which would print the baseline extinction probability when you knit the document. This will save you a lot of copying/pasting, reduce typos, and ensure that if you change the code, the text will automatically be updated with the new results.</p>
<hr>
<p>At this stage, you should also create object called <code>base_monitoring_pva</code> with the monitoring threshold used as the <code>extinction.threshold</code> argument.</p>
</div>
<div id="management-actions" class="section level2">
<h2 class="hasAnchor">
<a href="#management-actions" class="anchor"></a>Management actions</h2>
<p>With the baseline predictions, you are now ready to explore several management actions that could be taken to reduce the extinction risk of the checkerspot. These actions include:</p>
<ol style="list-style-type: decimal">
<li><p>Increase <code>K</code> by creating new habitat</p></li>
<li><p>Decrease the frequency of fires by more aggressively managing them before they become severe</p></li>
</ol>
<p>Due to the stochasticity inherent to the dynamics of this species, it’s hard to know exactly how these two options will influence extinction risk. So you will simulate dynamics under different combinations of these two options. To run these simulations, you will use the <code><a href="../reference/alternative_pva.html">alternative_pva()</a></code> function which takes two arguments:</p>
<ul>
<li>
<code>K</code> - the future value of <code>K</code> due to habitat creation</li>
<li>
<code>fire.prob</code> - the future fire frequency due to fire management</li>
</ul>
<p>This function will also return a data frame with the same information as <code>baseline_pva</code>, which will allow you estimate the extinction probability and time to extinction for the management scenario you created. In addition, it will save the figure to the folder where your .Rmd file is located (the figure will be called <code>alternative_pva.png</code>).</p>
<p>You should also run the function with <code>extinction.threshold=10</code> to check the monitoring objective..</p>
<p>Of course, management costs money and money is limited. Every 1% increase in <code>K</code> costs $500 and every 1% decrease in fire frequency costs $1500. The total available funds for this project is $100,000. If the proposed combination of increased <code>K</code> and decreased fire probability exceeds the total cost, you will get an error message stating that you need to either reduce <code>K</code> or allow a higher fire probability.</p>
<p>Run this function as many times as needed from within the chunk until you are satisfied that you have found the combination of habitat creation and fire reduction that best meets the stated management objectives.</p>
</div>
<div id="completing-the-assignment" class="section level2">
<h2 class="hasAnchor">
<a href="#completing-the-assignment" class="anchor"></a>Completing the assignment</h2>
<p>Once you have your recommended management actions, write up your recommendations for the working group. Write the text in the main body of the .Rmd file. Be sure to refer to the outline we developed in class during the writing assignment activity.</p>
<p>Remember that you will receive extra credit on the assignment if you get and incorporate feedback from the science writing center!</p>
<p>When you have completed the assignment, <strong>upload the .html, .Rmd, and .png files</strong> (we will need the figure file in order to reproduce the assignment on our local computer).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setting-up-the-lab">Setting up the lab</a></li>
      <li><a href="#simulating-stochastic-population-dynamcs">Simulating stochastic population dynamcs</a></li>
      <li><a href="#factor-1-growth-rate">Factor 1: Growth rate</a></li>
      <li><a href="#factor-2-carrying-capacity">Factor 2: Carrying capacity</a></li>
      <li><a href="#factor-3-variability-in-r">Factor 3: Variability in <code>r</code></a></li>
      <li><a href="#factor-4-initial-population-size">Factor 4: Initial population size</a></li>
      <li><a href="#factor-5-strenth-of-density-dependence">Factor 5: Strenth of density dependence</a></li>
      <li><a href="#on-your-own">On your own</a></li>
      <li><a href="#putting-it-all-together">Putting it all together</a></li>
      <li>
<a href="#homework-3-population-viability-of-the-violet-winged-checkerspot">Homework 3: Population viability of the violet-winged checkerspot</a><ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#setting-up-the-assignment">Setting up the assignment</a></li>
      <li><a href="#baseline-extinction-risk">Baseline extinction risk</a></li>
      <li><a href="#management-actions">Management actions</a></li>
      <li><a href="#completing-the-assignment">Completing the assignment</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
